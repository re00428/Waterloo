<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Main Page</title>
<style>
  /* Add your CSS styles here */
</style>
</head>
<body>
<div class="header">
  <h1>waterloo</h1>
</div>

<div class="container">
  <h2>Main Page</h2>
  <p>Welcome to the main page of our GitHub-like website. Below are some subpages:</p>
  <form id="searchForm">
    <input type="text" id="searchInput" placeholder="Enter keywords">
    <button type="submit">Search</button>
  </form>
  <div id="searchResults"></div>
</div>

<script>
document.getElementById("searchForm").addEventListener("submit", async function(event) {
  event.preventDefault();
  var searchInput = document.getElementById("searchInput").value.toLowerCase();
  var searchResults = document.getElementById("searchResults");
  searchResults.innerHTML = ""; // Clear previous search results
  
  console.log("Search input:", searchInput);
  
  // Function to fetch content of a subpage
  async function fetchSubpageContent(subpageLink) {
    try {
      const response = await fetch(subpageLink.href);
      if (!response.ok) {
        throw new Error('Failed to fetch');
      }
      const content = await response.text();
      console.log("Content of", subpageLink.href, ":", content);
      return content.toLowerCase();
    } catch (error) {
      console.error('Error fetching subpage content:', error);
      return ''; // Return empty string on error
    }
  }
  
  // Loop through subpage links and fetch their content
  var subpageLinks = document.querySelectorAll(".subpage-link");
  console.log("Subpage links:", subpageLinks);
  var fetchPromises = Array.from(subpageLinks).map(fetchSubpageContent);
  
  console.log("Fetch promises:", fetchPromises);
  
  // Wait for all fetch requests to complete
  var contents = await Promise.all(fetchPromises);
  console.log("Contents of all subpages:", contents);
  
  // Perform search after all content is fetched
  var hasResults = false;
  subpageLinks.forEach(function(link, index) {
    var subpageContent = contents[index];
    if (subpageContent.includes(searchInput)) {
      var resultLink = document.createElement("a");
      resultLink.href = link.href;
      resultLink.textContent = link.textContent;
      searchResults.appendChild(resultLink);
      searchResults.appendChild(document.createElement("br")); // Add line break for better separation
      hasResults = true;
    }
  });
  
  if (!hasResults) {
    searchResults.textContent = "No matching subpages found.";
  }
});
</script>

<div class="container">
  <h2>Main Page</h2>
  <p>Welcome to the main page of our GitHub-like website. Below are some subpages:</p>
  <ul>
    <li><a href="subpage1.html" class="subpage-link">Subpage 1</a></li>
    <li><a href="subpage2.html" class="subpage-link">Subpage 2</a></li>
    <!-- Add more subpage links as needed -->
  </ul>
</div>

</body>
</html>
